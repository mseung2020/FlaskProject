<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8">
    <!-- 반응형 디자인을 위한 viewport 설정 -->
    <meta name="viewport" content="width=1200">
    <title>NewCandle™</title>
    <link rel="icon" type="image/jpeg" href="{{ url_for('static', filename='image/logo.png') }}">
    <link rel="preload" as="image" href="{{ url_for('static', filename='image/logo.png') }}">
    
    <!-- Chart.js 및 확대/축소 플러그인 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.2.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.0"></script>

    <!-- 외부 CSS 파일 -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/page1.css') }}">
  </head>
  <body>
    <!-- 헤더 영역: 사이트 로고 및 네비게이션 -->
    <header role="banner">
      <div class="header-left">
        <img src="{{ url_for('static', filename='image/logo.png') }}" alt="NewCandle Logo" class="header-logo" onclick="location.href='/'">
        <h1 class="logo" onclick="location.href='/'" tabindex="0">NewCandle™</h1>
      </div>
      <div class="header-right">
        <nav aria-label="메인 네비게이션">
          <a href="/index" class="header-link">● 종목 분석</a>
          <a href="/page2" class="header-link">● 투자 정보 </a>
          <a href="/page3" class="header-link">● AI 연구</a>
        </nav>
      </div>
    </header>
    
    <!-- 메인 컨테이너: 그리드 레이아웃으로 구성 -->
    <main id="mainContainer">
      <!-- 1. 종목 검색 박스 -->
      <section id="stockSearchBox" class="box" aria-label="종목 검색">
        <input type="text" id="searchInput" placeholder="회사명 검색" aria-label="회사명 검색">
        <button onclick="searchByName()" aria-label="검색">검색</button>
      </section>
      
      <!-- 2. 일수 검색 및 옵션 설정 박스 -->
      <section id="daysSearchBox" class="box" aria-label="조회 기간 및 옵션 설정">
        <input type="text" id="daysInput" placeholder="242" aria-label="조회 기간 (1~365)">
        <button onclick="requestChart()" aria-label="조회">확인</button>
        <!-- 이동평균선 토글 -->
        <div id="toggleSections1">
          <input type="checkbox" id="toggleMovingAverage" checked>
          <label for="toggleMovingAverage">이동평균선</label>
        </div>
        <!-- 볼린저밴드 토글 -->
        <div id="toggleSections1">
          <input type="checkbox" id="togglebollinger" unchecked>
          <label for="togglebollinger">볼린저밴드</label>
        </div>
        <!-- 조회 기준 날짜 표시 -->
        <div id="date_label">조회 기준: Loading....</div>
      </section>
      
      <!-- 3. 종목 리스트 박스 -->
      <section id="stockListBox" class="box" aria-label="종목 리스트">
        <div id="stockContainer"></div>
      </section>
      
      <!-- 4. 상단 차트 영역 (캔들차트) -->
      <section id="chartBox" class="box" aria-label="주가 차트">
        <div id="chartLabel" class="chart_label" style="visibility: hidden;"></div>
        <div id="maLabel" class="ma_label" style="visibility: hidden;"></div>
        <div id="bollingerLabel" class="bollinger_label" style="visibility: hidden;"></div>
        <canvas id="myChart" aria-label="주가 캔들 차트"></canvas>
      </section>
      
      <!-- 5. 보조지표 옵션 체크박스 영역 -->
      <section id="emptyBox" class="box" aria-label="보조지표 옵션 선택">
        <div id="toggleSections2">
          <div class="indicatorItem">
            <input type="checkbox" id="toggleVolume" checked>
            <label for="toggleVolume">거래량</label>
          </div>
          <div class="indicatorItem">
            <input type="checkbox" id="toggleTradingvalue">
            <label for="toggleTradingvalue">거래대금</label>
          </div>          
          <div class="indicatorItem">
            <input type="checkbox" id="toggleADX">
            <label for="toggleADX">ADX</label>
          </div>          
          <div class="indicatorItem">
            <input type="checkbox" id="toggleATR">
            <label for="toggleATR">ATR</label>
          </div>          
          <div class="indicatorItem">
            <input type="checkbox" id="toggleCCI">
            <label for="toggleCCI">CCI</label>
          </div>
          <div class="indicatorItem">
            <input type="checkbox" id="toggleMACD">
            <label for="toggleMACD">MACD</label>
          </div>          
          <div class="indicatorItem">
            <input type="checkbox" id="toggleROC">
            <label for="toggleROC">ROC</label>
          </div>
          <div class="indicatorItem">
            <input type="checkbox" id="toggleRSI">
            <label for="toggleRSI">RSI</label>
          </div>
          <div class="indicatorItem">
            <input type="checkbox" id="toggleSTOCH">
            <label for="toggleSTOCH">STOCH</label>
          </div>
          <div class="indicatorItem">
            <input type="checkbox" id="toggleSTOCHRSI">
            <label for="toggleSTOCHRSI">STOCHRSI</label>
          </div>          
          <div class="indicatorItem">
            <input type="checkbox" id="toggleUO">
            <label for="toggleUO">Ultimate Oscillator</label>
          </div>
          <div class="indicatorItem">
            <input type="checkbox" id="toggleWILLIAMS">
            <label for="toggleWILLIAMS">Williams %R</label>
          </div>

        </div>
      </section>
      
      <!-- 6. 하단 차트 영역 (보조지표 차트들) -->
      <section id="IndexBox" class="box" aria-label="보조지표 차트">
        <!-- 거래량 차트 -->
        <div id="volumeBox">
          <div id="volumeLabel" class="volume_label" style="display: none;"></div>
          <canvas id="myVolumeChart" aria-label="거래량 차트"></canvas>
        <!-- 거래대금 차트 -->
        </div>
        <div id="tradingvalueBox">
          <div id="tradingvalueLabel" class="tradingvalue_label" style="display: none;"></div>
          <canvas id="tradingvalueChart" aria-label="거래대금 차트"></canvas>
        </div>
        <!-- RSI 차트 -->
        <div id="rsiBox">
          <div id="rsiLabel" class="rsi_label" style="display: none;"></div>
          <canvas id="rsiChart" aria-label="RSI 차트"></canvas>
        </div>
        <!-- STOCH 차트 -->
        <div id="stochBox">
          <div id="stochLabel" class="stoch_label" style="display: none;"></div>
          <canvas id="stochChart" aria-label="STOCH 차트"></canvas>
        </div>
        <!-- STOCHRSI 차트 -->
        <div id="stochrsiBox">
          <div id="stochrsiLabel" class="stochrsi_label" style="display: none;"></div>
          <canvas id="stochrsiChart" aria-label="STOCHRSI 차트"></canvas>
        </div>
        <!-- MACD 차트 -->
        <div id="macdBox">
          <div id="macdLabel" class="macd_label" style="display: none;"></div>
          <canvas id="macdChart" aria-label="MACD 차트"></canvas>
        </div>
        <!-- ADX 차트 -->
        <div id="adxBox">
          <div id="adxLabel" class="adx_label" style="display: none;"></div>
          <canvas id="adxChart" aria-label="ADX 차트"></canvas>
        </div>
        <!-- Williams %R 차트 -->
        <div id="williamsBox">
          <div id="williamsLabel" class="williams_label" style="display: none;"></div>
          <canvas id="williamsChart" aria-label="Williams %R 차트"></canvas>
        </div>
        <!-- CCI 차트 -->
        <div id="cciBox">
          <div id="cciLabel" class="cci_label" style="display: none;"></div>
          <canvas id="cciChart" aria-label="CCI 차트"></canvas>
        </div>
        <!-- ATR 차트 -->
        <div id="atrBox">
          <div id="atrLabel" class="atr_label" style="display: none;"></div>
          <canvas id="atrChart" aria-label="ATR 차트"></canvas>
        </div>
        <!-- Ultimate Oscillator 차트 -->
        <div id="uoBox">
          <div id="uoLabel" class="uo_label" style="display: none;"></div>
          <canvas id="uoChart" aria-label="Ultimate Oscillator 차트"></canvas>
        </div>
        <!-- ROC 차트 -->
        <div id="rocBox">
          <div id="rocLabel" class="roc_label" style="display: none;"></div>
          <canvas id="rocChart" aria-label="ROC 차트"></canvas>
        </div>
      </section>

      <!-- 별도의 컨테이로 가로비율 조정(1:1) -->
      <div id="bottomRow1">
        <section id="tempBox1" class="box" aria-label="임시 차트1">
          <div id="tempContainer1">
            <div class="table-wrapper">

              <div id="financialHeader" class="financial-header">
                <h3 id="selectedStockName">"선택된 종목 정보가 없습니다."</h3>
                <p class="unit-info">(단위: 억 원, 주, %, 배)</p>
              </div>

              <table id="financialTable">
                <thead>
                  <tr>
                    <th>기간</th>
                    <th>부채비율</th>
                    <th>유보율</th>
                    <th>매출액<br>증가율</th>
                    <th>EPS<br>증가율</th>
                    <th>ROA</th>
                    <th>ROE</th>
                    <th>EPS</th>
                    <th>BPS</th>
                    <th>PER</th>
                    <th>PBR</th>
                    <th>EV/<br>EBITDA</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>24년</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>23년</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                  </tr>
                  <tr>
                    <td>22년</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                  </tr>
                </tbody>
              </table>

            </div>
          </div>
        </section>
        <section id="tempBox2" class="box" aria-label="임시 차트2">
          <div id="tempContainer2">
            <h3 style= "margin-left: 10px; margin-top: 10px;">재무 비율(안정성, 수익성, 성장성, 활동성, 시장성)</h3>
            <img src="{{ url_for('static', filename='image/wheel.png') }}" 
            style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 50px; height: auto;">
          </div>
        </section>
      </div>

      <div id="bottomRow2">
        <section id="tempBox3" class="box" aria-label="임시 차트3">
          <div id="tempContainer3">
            <h3 style= "margin-left: 10px; margin-top: 10px;">재무 비율(미정)</h3>
            <img src="{{ url_for('static', filename='image/wheel.png') }}" 
            style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 50px; height: auto;">
          </div>
        </section>
        <section id="tempBox4" class="box" aria-label="임시 차트4">
          <div id="tempContainer4">
            <h3 style= "margin-left: 10px; margin-top: 10px;">워드 클라우드</h3>
            <img src="{{ url_for('static', filename='image/wheel.png') }}" 
            style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 50px; height: auto;">
          </div>
        </section>
      </div>

    </main>

    <!-- 푸터 -->
    <footer>
      <p>&copy; 2025 NewCandle™. All rights reserved.</p>
    </footer>
    
    <!-- script.js 파일 로드: 기능과 차트 업데이트를 담당 -->
    <script src="{{ url_for('static', filename='js/page1.js') }}"></script>
  </body>
</html>
