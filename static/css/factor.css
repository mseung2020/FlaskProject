/* ========== [SUPERNOVA BENTO THEME] ========== */
:root {
  /* 컬러 팔레트 */
  --bg-color: #f8f9fa;
  --bg-pattern: radial-gradient(#d1d5db 1px, transparent 1px);
  --primary-color: #274c77;
  --accent-yellow: #ffeb3b;  
  --accent-blue: #a0c4ff;    
  --accent-red: #ff7675;     
  --white: #ffffff;
  --black: #111111;

  /* 테두리 & 그림자 */
  --border-width: 3px;
  --border-radius: 16px;
  --hard-shadow: 6px 6px 0px var(--black);

  /* 폰트 */
  --font-main: 'Noto Sans KR', sans-serif;
  --font-display: 'Black Han Sans', sans-serif;
  --font-eng: 'Space Grotesk', sans-serif;
  
  --header-height: 70px;
}

/* ----- 기본 초기화 ----- */
html, body {
  font-family: var(--font-main);
  margin: 0; padding: 0;
  background-color: var(--bg-color);
  background-image: var(--bg-pattern);
  background-size: 20px 20px;
  color: var(--black);
  height: 100%;
}

/* =========================================
   1. 헤더 (PC 햄버거 문제 해결)
========================================= */
header {
  background: var(--white);
  height: var(--header-height);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 40px;
  border-bottom: var(--border-width) solid var(--black);
  position: sticky; top: 0; z-index: 100;
}

.header-left { display: flex; align-items: center; gap: 10px; }
.header-logo { height: 36px; border: 2px solid var(--black); border-radius: 20%; cursor: pointer; }
.logo {
  font-family: var(--font-eng); font-size: 1.5rem; font-weight: 700;
  margin: 0; cursor: pointer; letter-spacing: -0.5px;
}

@keyframes logoWiggle {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(-12deg); } /* 왼쪽으로 살짝 기울임 */
  50% { transform: rotate(12deg); }  /* 오른쪽으로 살짝 기울임 */
  75% { transform: rotate(-5deg); }  /* 다시 살짝 왼쪽 */
  100% { transform: rotate(0deg); }  /* 제자리 */
}

/* .header-left(로고+텍스트 컨테이너)에 마우스를 올리면... */
.header-left:hover .header-logo {
  /* ...로고 이미지(.header-logo)가 애니메이션을 실행함 */
  animation: logoWiggle 0.6s ease-in-out;
}

/* [중요] PC에서는 햄버거 아이콘 무조건 숨김 */
.menu-icon { display: none; }

#main-nav { display: flex; gap: 15px; }
.header-link {
  text-decoration: none; color: var(--black); font-weight: 700; font-size: 1.1rem;
  padding: 8px 15px; border-radius: 8px; border: 2px solid transparent; transition: 0.2s;
}
.header-link:hover, .header-link.active {
  background: var(--accent-yellow);
  border: 2px solid var(--black);
  box-shadow: 4px 4px 0 var(--black);
  transform: translate(-2px, -2px);
}

/* =========================================
   2. 레이아웃 & 벤토 박스 공통
========================================= */
#mainContainer {
  max-width: 1400px; margin: 30px auto; padding: 0 20px;
  display: grid; grid-template-columns: 1.3fr 1fr; gap: 20px;
  align-items: start;
}
.column-left, .column-right { display: flex; flex-direction: column; gap: 20px; 
  opacity: 0; /* 처음에 안 보이게 숨김 */
  animation: fadeInUp 1.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
}

/* 1. 애니메이션 키프레임 정의 */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(1.25rem); /* 20px */
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#mainContainer > .column-left:nth-child(1){
  animation-delay: 0.2s;
}

#mainContainer > .column-right:nth-child(2){
  animation-delay: 0.4s;
}

/* 벤토 박스 */
.bento-box {
  background: var(--white);
  border: var(--border-width) solid var(--black);
  border-radius: 12px;
  box-shadow: var(--hard-shadow);
  overflow: hidden;
  padding: 0 !important;
  display: flex; flex-direction: column;
}

.panel-header {
  background: var(--black); color: var(--accent-yellow);
  font-family: var(--font-eng); font-weight: 700; padding: 10px 15px;
  border-bottom: var(--border-width) solid var(--black);
  font-size: 0.9rem; letter-spacing: 1px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.panel-body { padding: 20px; background: #fff; position: relative; flex: 1; }


/* =========================================
   3. Box 1: 차트
========================================= */
#Box1 { height: 330px; }
#returnChart { width: 100% !important; height: 100% !important; max-height: 260px; }

/* 컨테이너: 박스 정중앙 배치 */
.empty-state-container {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: transparent;
  z-index: 5; /* 차트보다는 위에, 로더보다는 아래 */
}

/* 소나(Sonar) 아이콘 래퍼 */
.sonar-wrapper {
  position: relative;
  width: 100px;
  height: 100px;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 20px;
}

/* 중앙 점 (고정) */
.sonar-emitter {
  width: 16px; height: 16px;
  background: var(--black);
  border-radius: 50%;
  z-index: 2;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
}

/* 퍼져나가는 파동 */
.sonar-wave {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 100%; height: 100%;
  border: 2px solid var(--black);
  border-radius: 50%;
  opacity: 0;
  animation: sonarWave 2s infinite cubic-bezier(0.1, 0.4, 0.2, 1);
}

/* 두 번째 파동은 시간차 공격 */
.sonar-wave.delay {
  animation-delay: 0.5s;
}

/* 파동 애니메이션 키프레임 */
@keyframes sonarWave {
  0% { width: 0; height: 0; opacity: 0.8; border-width: 4px; }
  100% { width: 100%; height: 100%; opacity: 0; border-width: 0px; }
}

/* 하단 텍스트 */
.empty-msg-text {
  font-family: var(--font-eng);
  font-weight: 900;
  font-size: 1.2rem;
  color: var(--black);
  text-align: center;
  letter-spacing: 1px;
}
.empty-msg-text span {
  font-size: 0.8rem;
  font-weight: 500;
  color: #666;
  margin-top: 5px;
  display: block;
}


/* =========================================
   4. Box 3: 결과 영역 (스크롤바 필승 코드)
========================================= */
#Content3 {
  display: flex;       
  gap: 15px;         
  height: 350px; /* [핵심] 높이 고정 */
}

.big-inner-box {
  flex: 1;             
  border: 2px solid var(--black);
  border-radius: 8px;
  position: relative;
  display: flex; 
  flex-direction: column; 
  overflow: hidden;    
  background: #ffffff;
}

/* 왼쪽 박스 (요약) */
.big-inner-box:first-child {
  background: #fffbe6;
  padding: 10px;
  overflow-y: auto;
}

/* 오른쪽 박스 (리스트) */
.big-inner-box:last-child {
  padding: 0;
}

#left-result {
  min-height: 180px;
}

.factor-tag-list {
  display: flex;       /* ★ 이 줄이 없으면 gap이 작동 안 함 */
  flex-direction: column; /* 세로로 쌓기 */
  align-items: flex-start; 
  gap: 6px;           /* 태그 사이 간격 (숫자 조절 가능) */
}

/* [핵심] 기업 리스트 스크롤 영역 */
#right-result {
  height: 100%;       /* 부모 높이 100% 채움 */
  max-height: 170px;  /* 사용자 지정 높이 제한 */
  overflow-y: auto;   /* 넘치면 스크롤 */
  width: 100%;
  
  /* [디자인 추가] 스크롤바와 내용 사이 여백 확보 */
  padding: 5px; 
  box-sizing: border-box; 
}

/* 1. 리스트 컨테이너 (여백 제거) */
.bento-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

/* 2. 리스트 아이템 (기본 상태) */
.bento-item {
  padding: 12px 15px;            /* 터치하기 편한 넉넉한 영역 */
  margin-bottom: 5px;            /* 아이템 사이 간격 */
  border-bottom: 2px solid #eee; /* 얇은 밑줄 대신 두툼한 회색 줄 */
  
  font-size: 0.95rem;
  font-weight: 500;
  color: var(--black);
  
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1); /* 부드러운 애니메이션 */
  border-radius: 6px;            /* 살짝 둥근 모서리 */
}

/* 3. 마우스 올렸을 때 (호버 효과) */
.bento-item:hover {
  background-color: #f1f3f5;     /* 연한 회색 배경 */
  transform: translateX(5px);    /* 오른쪽으로 쓱 밀리는 효과 */
  border-bottom-color: var(--black); /* 밑줄이 검은색으로 진해짐 */
}



/* 5. 스크롤바 디자인 (벤토 테마에 맞게 커스텀) */
#right-result::-webkit-scrollbar {
  width: 8px;
}
#right-result::-webkit-scrollbar-track {
  background: transparent; 
}
#right-result::-webkit-scrollbar-thumb {
  background: #ccc;       /* 얌전한 회색 핸들 */
  border-radius: 4px;     /* 둥글게 */
}
#right-result::-webkit-scrollbar-thumb:hover {
  background: #888;       /* 마우스 잡으면 진해짐 */
}


/* =========================================
   5. Box 2: 팩터 버튼 (4x4 그리드)
========================================= */
.button-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr); /* 4열 강제 */
  gap: 10px;
  height: 100%;
}

.factor-btn {
  background: var(--white);
  border: 2px solid var(--black);
  border-radius: 8px;

  font-weight: 700; color: var(--black);
  cursor: pointer;
  box-shadow: 3px 3px 0 rgba(0,0,0,0.1);
  transition: 0.1s;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  height: 75px; font-size: 0.85rem;
  position: relative;
}
.factor-btn .sub { font-size: 0.7rem; font-weight: 400; color: #555; margin-top: 4px; line-height: 1.2; }

.factor-btn:not(.disabled):not(.locked):hover { transform: translateY(-2px); box-shadow: 4px 4px 0 var(--black); }
.factor-btn:not(.disabled):not(.locked):active { transform: translateY(2px); box-shadow: 1px 1px 0 var(--black); background: #eee; }
.factor-btn.active {
  background: var(--accent-blue); border-color: var(--black);
  box-shadow: inset 3px 3px 0 rgba(0,0,0,0.2); transform: translateY(2px);
}
.factor-btn.disabled { background: #f0f0f0; color: #aaa; border-color: #ccc; box-shadow: none; cursor: default; }

/* 잠금 버튼 */
.factor-btn.locked {
  background: #e9ecef; border: 2px dashed #bbb; cursor: default; box-shadow: none; overflow: hidden; height: 70px !important;
}
.tape-badge {
  position: absolute; background: var(--accent-yellow); color: var(--black); border: 2px solid var(--black);
  font-size: 0.6rem; font-weight: 900; font-family: var(--font-eng);
  padding: 2px 15px; transform: rotate(-10deg); box-shadow: 2px 2px 0 rgba(0,0,0,0.1); z-index: 10;
}


/* =========================================
   6. Box 4: 컨트롤 패널
========================================= */
#Box4 { flex: 1; min-height: 205px; }
.control-layout {
  display: flex; align-items: center; justify-content: space-between;
  gap: 20px; padding: 15px 25px;
}
.control-label-sm {
  font-family: var(--font-eng); font-size: 0.7rem; font-weight: 900; color: #888; margin-bottom: 8px;
}

/* AND/OR 토글 */
.box4-left { width: 120px; }
.logic-toggle { display: flex; background: #eee; border: 2px solid var(--black); border-radius: 8px; padding: 4px; gap: 4px; height: 60px;}
.selector-btn {
  flex: 1; border: none; background: transparent; padding: 8px 0;
  font-weight: 900; font-family: var(--font-eng); cursor: pointer; border-radius: 4px; color: #999; height: 55px;
}
.selector-btn.active { background: var(--accent-red); color: var(--black); border: 2px solid var(--black); box-shadow: 2px 2px 0 rgba(0,0,0,0.2); }

/* 슬라이더 */
.box4-center { flex: 1; padding: 0 10px; display: flex; flex-direction: column; }
#sliderWrapper { position: relative; height: 40px; display: flex; align-items: center; width: 100%; }
#sliderTrack { position: relative; width: 100%; height: 12px; background: var(--white); border: 2px solid var(--black); border-radius: 10px; }

.slider-mark-container { position: absolute; top: 18px; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; width: 60px; }
.slider-mark-container:nth-child(1) { left: 0%; }
.slider-mark-container:nth-child(2) { left: 33.33%; }
.slider-mark-container:nth-child(3) { left: 66.66%; }
.slider-mark-container:nth-child(4) { left: 100%; }

.slider-mark { width: 2px; height: 6px; background: var(--black); margin-bottom: 4px; }
.slider-label { font-size: 0.75rem; font-weight: 700; color: #555; white-space: nowrap; }
#sliderKnob {
  position: absolute; top: 50%; transform: translate(-50%, -50%); width: 24px; height: 24px;
  background: var(--accent-yellow); border: 2px solid var(--black); border-radius: 4px; cursor: grab; z-index: 10;
}
.smooth-transition {
  transition: left 0.3s cubic-bezier(0.25, 1, 0.5, 1) !important;
}

/* 실행 버튼 */
.box4-right { width: 140px; display: flex; align-items: flex-end; }
.box4-right-btn {
  width: 100%; height: 55px; background: var(--black); color: var(--accent-yellow);
  border: none; border-radius: 8px; font-family: var(--font-eng); font-weight: 900; font-size: 1.2rem;
  cursor: pointer; box-shadow: 5px 5px 0 #666; transition: 0.1s; display: flex; align-items: center; justify-content: center;
}
.box4-right-btn:hover { transform: translate(-2px, -2px); box-shadow: 7px 7px 0 #666; background: #222; }
.box4-right-btn:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0 #666; }


/* =========================================
   7. 기타 유틸리티 & 반응형
========================================= */
.hidden { display: none !important; }
.loader { position: absolute; top:0; left:0; width:100%; height:100%; display: flex; align-items: center; justify-content: center; z-index: 10; }
.loader-text{ font-weight: 900; font-size: 1rem; margin-top: 15px; animation: blink 1.5s infinite; }
@keyframes blink{ 50%{ opacity: .5; } }
/* 로딩 화면 위치 미세 조정 */
.spinner { width: 40px; height: 40px; background: var(--accent-red); border: 3px solid var(--black); animation: spin 1s infinite ease-in-out; 
  margin: 0 auto 10px auto; 
  position: relative;                     
  top: -10px; }
@keyframes spin { 0%{transform:rotate(0deg)} 100%{transform:rotate(360deg)} }

/* 텍스트 스타일 */
.bento-result-text h3 { margin: 0 0 10px 0; font-size: 1.2rem; }
.result-tag { background: #fff; border: 1px solid #000; padding: 2px 8px; border-radius: 12px; font-weight: bold; margin: 0 2px; }
.final-return { font-size: 1.3rem; font-weight: 900; text-align: right; margin-top: 10px; border-top: 2px dashed #ccc; padding-top: 0px; }
.text-plus { color: #e74c3c; } .text-minus { color: #3498db; }
.placeholder-msg { text-align: center; color: #888; font-size: 0.95rem; line-height: 2; padding-top: 50px;}
.placeholder-msg strong { background: var(--black); color: var(--accent-yellow); padding: 2px 6px; border-radius: 4px; }

/* 푸터 */
footer {
  background: var(--black); color: var(--white); text-align: center; padding: 10px 0; font-size: 0.9rem; margin-top: 40px;
}

/* 모바일 반응형 (900px 이하) */
@media (max-width: 900px) {
  /* PC 메뉴 숨기고 햄버거 보이기 */
  .header-link { display: none; }
  .menu-icon { display: block; font-size: 1.8rem; cursor: pointer; color: var(--black); }

  /* 모바일 네비게이션 드로어 */
  #main-nav.nav-active {
    position: fixed; top: 0; right: 0; height: 100vh; width: 250px;
    background: #fff; border-left: 3px solid #000; flex-direction: column;
    padding: 60px 20px; display: flex; z-index: 999; box-shadow: -10px 0 20px rgba(0,0,0,0.2);
  }
  #main-nav .header-link { display: block; text-align: center; margin-bottom: 15px; color: var(--black); }

  /* 레이아웃 1단 변경 */
  #mainContainer { grid-template-columns: 1fr; }
  .column-left { order: 2; } .column-right { order: 1; }
  
  #Content3 { flex-direction: column; height: auto; }
  .big-inner-box { min-height: 200px; }
  
  .control-layout { flex-direction: column; align-items: stretch; gap: 20px; }
  .box4-left { width: 100%; display: flex; justify-content: space-between; align-items: center; }
  .logic-toggle { width: 60%; }
  .box4-right { width: 100%; }
  
  .button-grid { grid-template-columns: repeat(2, 1fr); }
}